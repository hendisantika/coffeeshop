<!DOCTYPE html>
<html th:replace="~{fragments/layout :: layout(~{::content})}"
      xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="content">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-4">Dashboard</h1>
            <p class="lead text-muted">Welcome to Coffee Shop Management System</p>
        </div>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <div class="card stat-card h-100">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title text-uppercase opacity-75">Stores</h6>
                        <h2 class="mb-0" th:text="${storeCount}">0</h2>
                    </div>
                    <div class="stat-icon">&#127970;</div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <a class="text-white" th:href="@{/ui/stores}">View all &rarr;</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title text-uppercase opacity-75">Categories</h6>
                        <h2 class="mb-0" th:text="${categoryCount}">0</h2>
                    </div>
                    <div class="stat-icon">&#128193;</div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <a class="text-white" th:href="@{/ui/categories}">View all &rarr;</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title text-uppercase opacity-75">Products</h6>
                        <h2 class="mb-0" th:text="${productCount}">0</h2>
                    </div>
                    <div class="stat-icon">&#9749;</div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <a class="text-white" th:href="@{/ui/products}">View all &rarr;</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stat-card h-100">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title text-uppercase opacity-75">Orders</h6>
                        <h2 class="mb-0" th:text="${orderCount}">0</h2>
                    </div>
                    <div class="stat-icon">&#128722;</div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <a class="text-white" th:href="@{/ui/orders}">View all &rarr;</a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Recent Orders</h5>
                </div>
                <div class="card-body">
                    <div class="text-center text-muted py-4" th:if="${#lists.isEmpty(recentOrders)}">
                        <p>No orders yet. <a th:href="@{/ui/orders/new}">Create your first order!</a></p>
                    </div>
                    <div class="table-responsive" th:unless="${#lists.isEmpty(recentOrders)}">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Store</th>
                                <th>Status</th>
                                <th>Total</th>
                                <th>Date</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="order : ${recentOrders}">
                                <td>
                                    <a th:href="@{/ui/orders/{id}(id=${order.id})}"
                                       th:text="${#strings.substring(order.id, 0, 8) + '...'}"></a>
                                </td>
                                <td th:text="${order.customerName}"></td>
                                <td th:text="${order.store.name}"></td>
                                <td>
                                    <span class="badge status-badge"
                                          th:classappend="${order.status.name() == 'PENDING' ? 'bg-warning' :
                                                          order.status.name() == 'CONFIRMED' ? 'bg-info' :
                                                          order.status.name() == 'PREPARING' ? 'bg-primary' :
                                                          order.status.name() == 'READY' ? 'bg-success' :
                                                          order.status.name() == 'COMPLETED' ? 'bg-secondary' : 'bg-danger'}"
                                          th:text="${order.status}"></span>
                                </td>
                                <td th:text="${'$' + #numbers.formatDecimal(order.totalAmount, 1, 2)}"></td>
                                <td th:text="${#temporals.format(order.orderDate, 'MMM dd, HH:mm')}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a class="btn btn-coffee" th:href="@{/ui/orders/new}">
                            New Order
                        </a>
                        <a class="btn btn-outline-primary" th:href="@{/ui/products/new}">
                            Add Product
                        </a>
                        <a class="btn btn-outline-secondary" th:href="@{/ui/categories/new}">
                            Add Category
                        </a>
                        <a class="btn btn-outline-info" th:href="@{/ui/stores/new}">
                            Add Store
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
